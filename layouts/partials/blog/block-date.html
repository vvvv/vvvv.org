{{ if or .Params.who .Params.where }}
{{ $dateAndTime := time.Now }}
{{ $hasTimezone := false}}
{{ $time := $dateAndTime.Format "15:04" }}
<div class="meta mb-5">
    <table>
  {{ with .Params.who }}
      {{with .name}}
      <tr><td><b>Who: </b></td><td>{{.}}</td></tr>
      {{end}}
      {{with .credits}}
      <tr><td><b>Credits: </b></td><td>{{.}}</td></tr>
      {{end}}
  {{ end }}

  {{ with .Params.where }}
      {{with .location_name}}
      <tr><td><b>Location: </b></td><td>{{.}}</td></tr>
      {{end}}
      {{ if or .street .additional .city .country_name}}
        <tr><td><b>Where: </b></td><td>{{with .street}}{{.}}, {{end}}{{with .additional}}{{.}}, {{end}}{{with .city}}{{.}}, {{end}}{{with .country_name}}{{.}}{{end}}</td></tr>
      {{ end }}
        {{ if .lat}}
        {{ if and (ne .lat "None") (ne .long "None")}}
            <tr><td><b>Lat / Long: </b></td><td>{{.lat}} {{.long}}</td></tr>
        {{end}}
      {{end}}
      {{ with .from_date }}
        {{/* as int */}}
        {{ if eq (printf "%T" .) "int" }}
          {{ $dateAndTime = time . 0 }}
        {{/* as int string */}}
        {{ else if and (eq (printf "%T" .) "string") (findRE `^\d+$` .) }}
          {{ $dateAndTime = time (int .) }}
        {{/* as Human-readable: 2026-02-26T18:00:00 or add +0200 when a Timezone other than CET*/}}
        {{ else }}
          {{ $hasTimezone = or (findRE `Z$` .) (findRE `[+-]\d{2}:?\d{2}$` .) }}
          {{ $dateAndTime = time.AsTime . }}
        {{ end }}

        {{ $date := $dateAndTime.Format "02 Jan 2006" }}
        {{ if $hasTimezone }}
          {{ $time = $dateAndTime.Format "15:04 (-07:00)" }}
        {{ else }}
          {{ $time = $dateAndTime.Format "15:04 CET" }}
        {{ end }}
        {{ if ne . "0" }}
            <tr><td><b>{{ if ne $.Params.where.to_date . }}From:{{else}}When:{{end}} </b></td><td>{{$date}}{{ if ne $time "00:00"}} {{$time}}{{end}}</td></tr>
        {{ end }}
      {{end}}

      {{with .to_date}}
        
        {{/* as int */}}
        {{ if eq (printf "%T" .) "int" }}
          {{ $dateAndTime = time . }}
        {{/* as int string */}}
        {{ else if and (eq (printf "%T" .) "string") (findRE `^\d+$` .) }}
          {{ $dateAndTime = time (int .) }}
        {{/* as Human-readable: 2026-02-26T18:00:00-0200 YYYY-MM-DDTHH:MM:SS-ZONE */}}
        {{ else }}
          {{ $hasTimezone = or (findRE `Z$` .) (findRE `[+-]\d{2}:?\d{2}$` .) }}
          {{ $dateAndTime = time.AsTime . }}
        {{ end }}

        {{ $date := $dateAndTime.Format "02 Jan 2006" }}
        {{ if $hasTimezone }}
          {{ $time = $dateAndTime.Format "15:04 (-07:00)" }}
        {{ else }}
          {{ $time = $dateAndTime.Format "15:04 CET" }}
        {{ end }}
        {{ if and (ne . "0") (ne $.Params.where.from_date . ) }}
            <tr><td><b>To: </b></td><td>{{$date}}{{ if ne $time "00:00"}} {{$time}}{{end}} </td></tr>
        {{ end }}
      {{end}}
  {{ end }}
    </table>
</div>
{{ end }}